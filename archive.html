<!DOCTYPE html>
<html lang="ru">
<head>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Archive <span class="beta">v0.9</span></h1>
    <nav>
      <a href="index.html">Demon List</a>
      <a href="archive.html">Archive</a>
      <a href="players.html">Top Players</a>
      <a href="https://forms.gle/cXuwy3YN7Rp1eyra9" id="submit-record">Submit a Record</a>
      <a href="https://discord.gg/cg4QTF59z9" id="discord-link">Discord</a>
    </nav>
    <div class="archive-switcher">
      <button id="actual-archive" class="active">Фактический архив</button>
      <button id="official-archive">Официальный архив</button>
    </div>
  </header>

  <main>
    <div id="archive-list" class="archive-list">
    </div>
  </main>

  <div id="particles-js"></div>
  <canvas id="star-background"></canvas>
  <script>
document.addEventListener('DOMContentLoaded', () => {
    const actualArchiveButton = document.getElementById('actual-archive');
    const officialArchiveButton = document.getElementById('official-archive');
    const archiveList = document.getElementById('archive-list');

    async function fetchData(url) {
        const response = await fetch(url);
        return await response.json();
    }

    function getPlayerInfo(playerId, players) {
        return players.find(player => player.id === playerId);
    }

    async function loadArchive(type) {
        const levels = await fetchData('levels.json');
        const players = await fetchData('players.json');
        archiveList.innerHTML = '';

        levels.forEach((level, index) => {
            const archive = level.archives ? level.archives.find(archive => archive.type === type) : null;
            if (archive) {
                const firstPlayer = getPlayerInfo(level.players[0].id, players);
                const position = levels.indexOf(level) + 1;

                const archiveLevelCard = document.createElement('div');
                archiveLevelCard.className = 'archive-level-card';
                archiveLevelCard.innerHTML = `
                    <h2>#${position} - ${level.name}</h2>
                    <p>${firstPlayer.nickname}</p>
                    <p class="archive-dates">${archive.date_start} - ${archive.date_end} (${archive.duration_days} дней)</p>
                `;
                archiveLevelCard.addEventListener('click', () => {
                    window.location.href = `level.html?id=${position}`;
                });
                archiveList.appendChild(archiveLevelCard);
            }
        });
    }

    actualArchiveButton.addEventListener('click', () => {
        actualArchiveButton.classList.add('active');
        officialArchiveButton.classList.remove('active');
        loadArchive('actual');
    });

    officialArchiveButton.addEventListener('click', () => {
        officialArchiveButton.classList.add('active');
        actualArchiveButton.classList.remove('active');
        loadArchive('official');
    });

    loadArchive('actual');
});
  </script>
  <script src="particles-config.js"></script>
  <script src="script.js"></script>
  <script src="stars.js"></script>
  <script src="animations.js"></script>
  <script src="sounds.js"></script>
</body>
</html>